#!/bin/bash

# Fresh token from the script output
TOKEN="eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJTNnZIMkkxM25vRk0zWE9uZlc0UDRhZWVKa1ZfMXhvbVBWVV9KZU5kSTJVIn0.eyJleHAiOjE3NTc5NjA1ODYsImlhdCI6MTc1Nzk2MDI4NiwianRpIjoiNjc2M2U2NTctZDA1Yi00YWQ2LWI0OWQtNTc5ODVjMTZmZWNlIiwiaXNzIjoiaHR0cDovL2F1dGgudGlwLmxvY2FsaG9zdC9yZWFsbXMvdGlwIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6ImVlZWYyNDExLTllN2QtNDc2OS1hODdiLWMxMDU3MDMzY2Y3MyIsInR5cCI6IkJlYXJlciIsImF6cCI6InRpcC1hcHAiLCJzZXNzaW9uX3N0YXRlIjoiMzU2ZDhkN2QtMjBmYy00NzZkLTg2MmEtY2YzOWI3YjAwNmM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vdGlwLmxvY2FsaG9zdCIsImh0dHA6Ly9sb2NhbGhvc3Q6KiJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsiZGVmYXVsdC1yb2xlcy10aXAiLCJvZmZsaW5lX2FjY2VzcyIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwic2lkIjoiMzU2ZDhkN2QtMjBmYy00NzZkLTg2MmEtY2YzOWI3YjAwNmM3IiwiZW1haWxfdmVyaWZpZWQiOnRydWUsIm5hbWUiOiJSaWNoYXJkIFJvYWNoIiwicHJlZmVycmVkX3VzZXJuYW1lIjoicmljaGFyZC5yb2FjaCIsImdpdmVuX25hbWUiOiJSaWNoYXJkIiwiZmFtaWx5X25hbWUiOiJSb2FjaCIsImVtYWlsIjoicmljaGFyZC5yb2FjaEBnbWFpbC5jb20ifQ.d__lDPkOBjBR3_-uS44CAKLEUcnW-kiEm_hl3WlxH_wVCZkyCqd1JiYgftOYGp-r8FF58Jc6_8Dnshl8wJmazDeRWtbz5JZVL2_1kRXl6AeOAyHPN5zCUGlr7k39ijQvCe2DnSp7uF0KWA3OfD4sJbSrjIUvHzVbWrW3M7gzO3Ah-bqwsBmTTbUzW_M3WTrtGm4-Btp3N-nUHi_yteU2etzVzbLYzF1_Kvf9PyL-KNbspxO0VcSBlxaISNYT0h321nclTRobKUEFHpR5a6aaaO95XKd_Aq6iV25q2m0mo_hWvagBQzGUf0tWh0vB2zVbIU6raBCxYkZDuJuEkOdcEg"

echo "Testing backend with fresh token..."
curl -X POST 'http://localhost:3000/api/auth/login' \
  -H 'Content-Type: application/json' \
  -d "{\"keycloakToken\": \"$TOKEN\"}"

echo ""
echo "Done!"